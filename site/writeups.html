<!doctype html><html lang="en"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Writeups â€” Flagaholic</title>
<link rel="stylesheet" href="./css/site.css">
</head><body><div class="wrap">
  <header>
    <div class="brand">
      <img class="logo" src="./assets/teamlogo/teampfp.png" alt="Flagaholic" width="40" height="40">
      <strong>Flagaholic</strong>
    </div>
    <nav>
      <a href="./index.html">Home</a>
      <a href="./members.html">Members</a>
      <a href="./achievements.html">Achievements</a>
      <a href="./writeups.html" class="active">Writeups</a>
      <a href="./contact.html">Contact</a>
    </nav>
  </header>

  <script>
    async function loadDirectory() {
      const apiBase = 'https://api.github.com/repos/Flagaholic/flagaholic.github.io/contents/site/writeups';
      const ul = document.getElementById('writeups-list');

      const existingHrefs = new Set(
        Array.from(ul.querySelectorAll('a'))
          .map(a => (a.getAttribute('href') || '').trim().toLowerCase())
          .filter(Boolean)
      );
      const existingTexts = new Set(
        Array.from(ul.querySelectorAll('a'))
          .map(a => (a.textContent || '').trim().toLowerCase())
          .filter(Boolean)
      );

      const markExisting = (href, text) => {
        if (href) existingHrefs.add(href.toLowerCase());
        if (text) existingTexts.add(text.toLowerCase());
      };

      try {
        const dirRes = await fetch(apiBase);
        if (!dirRes.ok) {
          ul.insertAdjacentHTML('beforeend', '<li>Unable to load writeups, please try again later. If this issue persists, scream at us in discord and we will fix it asap</li>');
          return;
        }

        const files = await dirRes.json();
        files.sort((a, b) => {
          if (a.type === b.type) return a.name.localeCompare(b.name);
          return a.type === 'dir' ? -1 : 1;
        });

        for (const f of files) {
          let href = '';
          let label = '';

          if (f.type === 'dir') {
            const readmeRes = await fetch(`${apiBase}/${encodeURIComponent(f.name)}/README.md`);
            href = readmeRes.ok
              ? `./writeups/${encodeURIComponent(f.name)}/README.md`
              : `./writeups/${encodeURIComponent(f.name)}/`;
            label = f.name.replace(/[-_]/g, ' ');
          } else if (f.type === 'file') {
            if (f.name.toLowerCase() === 'readme.md') continue;
            href = `./writeups/${encodeURIComponent(f.name)}`;
            label = f.name;
          } else {
            continue;
          }

          const hrefKey = (href || '').toLowerCase();
          const textKey = (label || '').toLowerCase();

          if (existingHrefs.has(hrefKey) || existingTexts.has(textKey)) {
            markExisting(hrefKey, textKey);
            continue;
          }

          const li = document.createElement('li');
          const a = document.createElement('a');
          a.setAttribute('href', href);
          a.textContent = label;
          li.appendChild(a);
          ul.appendChild(li);

          markExisting(hrefKey, textKey);
        }

        const readmeRes = await fetch(`${apiBase}/README.md`);
        if (readmeRes.ok) {
          const readme = await readmeRes.json();
          const decoded = atob(readme.content);
          const readmeEl = document.getElementById('readme');
          if (readmeEl) {
            readmeEl.innerHTML = `<pre>${decoded}</pre>`;
          } else {
            const container = document.createElement('div');
            container.id = 'readme';
            container.style.marginTop = '1em';
            container.innerHTML = `<pre>${decoded}</pre>`;
            ul.parentElement.appendChild(container);
          }
        }
      } catch (err) {
        ul.insertAdjacentHTML('beforeend', '<li>Error loading writeups</li>');
        console.error(err);
      }
    }

    document.addEventListener('DOMContentLoaded', loadDirectory);
  </script>

  <main class="main">
    <div class="card"><h1>Writeups</h1>
      <ul id="writeups-list">
        <!-- populated dynamically unless entries manually added here (idk cuz your wu is special or the auto fetch script is crying for help and can't get your writeup or sth) -->
      </ul>
      <div id="readme" style="margin-top:1em;"></div>
    </div>
  </main>
</div></body></html>
